<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>Galaxy Clusters</title>

	<!-- Favicon -->
	<link rel="icon" href="/static/icons/favicon.ico" sizes="any">
	<link rel="icon" href="/static/icons/favicon.svg" type="image/svg+xml">
	<link rel="shortcut icon" href="/static/icons/favicon.ico">
	<link rel="apple-touch-icon" href="/static/icons/favicon.ico">
	<meta name="msapplication-TileImage" content="/static/icons/favicon.ico">

	<!-- CSS -->
	<link rel="stylesheet" href="/static/fonts/fonts.css">
	<link rel="stylesheet" href="/static/css/main.css">
	<script src="https://cdn.tailwindcss.com"></script>

	<!-- Preload critical resources -->
	<link rel="preload" href="/js/aladin.js" as="script">
	<link rel="dns-prefetch" href="//aladin.u-strasbg.fr">
	<link rel="dns-prefetch" href="//alasky.u-strasbg.fr">
	<link rel="dns-prefetch" href="//cds.u-strasbg.fr">
	<link rel="dns-prefetch" href="//api.adsabs.harvard.edu">

	<!-- JavaScript -->
	<script src="/js/site-texts.js"></script>
	<script src="/js/page-content.js"></script>
	<script src="/js/spa-navigator.js"></script>
	<script src="/js/ads-search.js"></script>

	<!-- MathJax Configuration -->
	<script>
		window.MathJax = {
			tex: {
				inlineMath: [['$', '$'], ['\\(', '\\)']],
				displayMath: [['$$', '$$'], ['\\[', '\\]']],
				processEscapes: true,
				processEnvironments: true
			},
			options: {
				skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
			}
		};
	</script>
	<script type="text/javascript" id="MathJax-script" async
		src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
		</script>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col loading">
	<header class="sticky top-0 z-50 relative p-4 flex items-center justify-center bg-white shadow min-h-[64px]">
		<a href="#" id="back-btn"
			class="absolute left-4 group flex items-center text-blue-600 hover:text-blue-800 transition"
			style="display: none;">
			<svg class="w-6 h-6 mr-1 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor"
				stroke-width="2" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
			</svg>
			<span class="text-base font-medium">Back</span>
		</a>
		<div id="header-title" class="text-2xl font-bold text-gray-800 transition">
			<span class="full-text">Galaxy Clusters</span>
			<span class="mobile-short">GC</span>
		</div>

		<!-- Font & Language & Theme Switchers -->
		<div class="absolute right-4 items-center gap-3" id="desktop-controls" style="display: flex;">
			<!-- Theme Switcher -->
			<button id="theme-toggle"
				class="px-3 py-1 text-sm font-medium text-gray-600 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-all duration-200 flex items-center gap-1">
				<svg id="theme-icon" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2"
					viewBox="0 0 24 24">
					<path id="sun-icon" stroke-linecap="round" stroke-linejoin="round"
						d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
					<path id="moon-icon" stroke-linecap="round" stroke-linejoin="round"
						d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
						style="display: none;" />
				</svg>
				<span id="theme-text">Light</span>
				<div class="tooltip">Toggle Theme</div>
			</button>

			<!-- Font Switcher -->
			<div class="relative">
				<button id="font-dropdown-btn"
					class="px-3 py-1 text-sm font-medium text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded transition-all duration-200 flex items-center gap-1">
					<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16" />
					</svg>
					<span id="current-font">Default</span>
					<svg class="w-3 h-3 transition-transform" id="font-dropdown-arrow" fill="none" stroke="currentColor"
						stroke-width="2" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
					</svg>
					<div class="tooltip">Change Font</div>
				</button>
				<div id="font-dropdown"
					class="absolute right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[180px] max-h-[400px] overflow-y-auto hidden">
				</div>
			</div>

			<!-- Language Switcher -->
			<div class="relative">
				<button id="language-dropdown-btn"
					class="px-3 py-1 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-all duration-200 flex items-center gap-1">
					<span id="current-lang">EN</span>
					<svg class="w-4 h-4 transition-transform" id="dropdown-arrow" fill="none" stroke="currentColor"
						stroke-width="2" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
					</svg>
				</button>
				<div id="language-dropdown"
					class="absolute right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[80px] hidden">
				</div>
			</div>
		</div>

		<!-- Mobile Menu Button and Its Setup -->
		<button id="mobile-menu-btn"
			class="absolute right-4 p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"
			style="display: none;">
			<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<circle cx="12" cy="12" r="1" />
				<circle cx="12" cy="5" r="1" />
				<circle cx="12" cy="19" r="1" />
			</svg>
		</button>
	</header>

	<div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"
		style="transition: opacity 0.3s ease;"></div>

	<div id="mobile-menu"
		class="fixed top-0 right-0 h-full w-full bg-white shadow-2xl z-50 transform translate-x-full transition-transform duration-300 ease-in-out">
		<div class="flex flex-col h-full">
			<div class="flex items-center justify-center p-6 border-b border-gray-200 relative">
				<h3 class="text-lg font-semibold text-gray-900">Settings</h3>
				<button id="mobile-menu-close"
					class="absolute right-4 p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"
					aria-label="Close settings">
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
							d="M6 18L18 6M6 6l12 12" />
					</svg>
				</button>
			</div>

			<div class="flex-1 overflow-y-auto p-6 space-y-6">
				<div class="space-y-3">
					<label class="text-sm font-medium text-gray-700">Theme</label>
					<div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
						<div class="flex items-center gap-3">
							<svg id="mobile-theme-icon" class="w-5 h-5 text-indigo-600" fill="none"
								stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
								<path id="mobile-sun-icon" stroke-linecap="round" stroke-linejoin="round"
									d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
								<path id="mobile-moon-icon" stroke-linecap="round" stroke-linejoin="round"
									d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
									style="display: none;" />
							</svg>
							<span id="mobile-theme-text" class="text-gray-800">Light</span>
						</div>
						<button id="mobile-theme-toggle"
							class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
							<span id="mobile-theme-switch"
								class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-1"></span>
						</button>
					</div>
				</div>

				<div class="space-y-3">
					<label class="text-sm font-medium text-gray-700">Language</label>
					<div class="space-y-2" id="mobile-language-options">
					</div>
				</div>
			</div>
		</div>
	</div>

	<main class="flex-1 flex flex-col items-center justify-center px-4">
	</main>

	<script>
		(function () {
			const showContent = () => {
				document.body.offsetHeight;

				document.body.classList.remove('loading');
				document.body.classList.add('ready');
			};

			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', () => {
					setTimeout(showContent, 50);
				});
			} else {
				setTimeout(showContent, 50);
			}
		})();

		(function () {
			let isLanguageChanging = false;

			const LANGUAGE_NAMES_FULL = {
				'en': 'English',
				'ru': 'Русский',
				'debugLang': 'Debug Lang',
			};

			const LANGUAGE_NAMES_SHORT = {
				'en': 'EN',
				'ru': 'RU',
				'debugLang': 'DL',
			};

			window.LANGUAGE_NAMES_FULL = LANGUAGE_NAMES_FULL;
			window.LANGUAGE_NAMES_SHORT = LANGUAGE_NAMES_SHORT;

			const initializeLanguage = () => {
				const currentLang = window.getCurrentLanguage();
				populateLanguageDropdown();
				updateLanguageButtons(currentLang);
				updatePageTexts(currentLang);

				document.getElementById('language-dropdown-btn')?.addEventListener('click', (e) => {
					e.stopPropagation();
					const dropdown = document.getElementById('language-dropdown');
					const arrow = document.getElementById('dropdown-arrow');

					if (dropdown.classList.contains('hidden')) {
						dropdown.classList.remove('hidden');
						arrow.style.transform = 'rotate(180deg)';
					} else {
						dropdown.classList.add('hidden');
						arrow.style.transform = 'rotate(0deg)';
					}
				});

				document.addEventListener('click', () => {
					document.getElementById('language-dropdown')?.classList.add('hidden');
					document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';
				});
			};

			const populateLanguageDropdown = () => {
				const dropdown = document.getElementById('language-dropdown');
				if (!dropdown || !window.SITE_TEXTS) return;

				const languages = Object.keys(window.SITE_TEXTS);
				dropdown.innerHTML = '';

				languages.forEach((lang, index) => {
					const button = document.createElement('button');
					button.className = `lang-option w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors`;
					button.setAttribute('data-lang', lang);

					if (index === 0) button.classList.add('rounded-t-lg');
					if (index === languages.length - 1) button.classList.add('rounded-b-lg');

					const langName = LANGUAGE_NAMES_FULL[lang];
					button.textContent = langName;

					button.addEventListener('click', (e) => {
						const selectedLang = e.target.getAttribute('data-lang');
						changeLanguage(selectedLang);

						dropdown.classList.add('hidden');
						document.getElementById('dropdown-arrow').style.transform = 'rotate(0deg)';
					});

					dropdown.appendChild(button);
				});
			};

			const changeLanguage = (lang) => {
				if (isLanguageChanging) return;
				isLanguageChanging = true;

				document.body.style.opacity = '0.7';

				setTimeout(() => {
					window.setLanguage(lang);
					updateLanguageButtons(lang);
					updatePageTexts(lang);

					document.documentElement.setAttribute('lang', lang);

					if (window.spaNavigator) {
						const currentPage = window.location.pathname.replace(/^\//, '').replace(/\.html$/, '') || 'home';
						window.spaNavigator.loadPageContent(currentPage);
					}

					document.body.style.opacity = '1';
					isLanguageChanging = false;
				}, 300);
			};

			const updateLanguageButtons = (lang) => {
				const currentLangDisplay = document.getElementById('current-lang');
				if (currentLangDisplay) {
					currentLangDisplay.textContent = LANGUAGE_NAMES_FULL[lang];
				}
			};
			window.updateLanguageButtons = updateLanguageButtons;
			window.populateLanguageDropdown = populateLanguageDropdown;

			const updatePageTexts = (lang) => {
				const headerTitle = document.querySelector('#header-title .full-text');
				const headerTitleShort = document.querySelector('#header-title .mobile-short');
				if (headerTitle && window.getText) {
					headerTitle.innerHTML = window.getText('siteTitle', lang) + '<sup style="color: red; font-style: italic; font-size: 0.7em;">preview</sup>';
				}
				if (headerTitleShort && window.getText) {
					headerTitleShort.innerHTML = window.getText('siteTitleShort', lang) + '<sup style="color: red; font-style: italic; font-size: 0.7em;">β</sup>';
				}

				const backBtnText = document.querySelector('#back-btn span');
				if (backBtnText && window.getText) {
					backBtnText.textContent = window.getText('back', lang);
				}

				if (window.getText) {
					const currentPage = window.location.pathname.replace(/^\//, '').replace(/\.html$/, '') || 'home';
					const titleKey = currentPage + 'PageTitle';
					const pageTitle = window.getText(titleKey, lang);
					if (pageTitle !== titleKey) {
						document.title = pageTitle;
					}
				}
			};
			window.updatePageTexts = updatePageTexts;

			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', initializeLanguage);
			} else {
				initializeLanguage();
			}

			window.addEventListener('languageChanged', (e) => {
				updateLanguageButtons(e.detail.language);
				updatePageTexts(e.detail.language);
			});
		})();

		(function () {
			const fonts = {
				'default': { name: 'Default', family: 'system-ui, -apple-system, sans-serif', category: 'System' },

				'inter': { name: 'Inter', family: "'Inter', sans-serif", category: 'Modern' },
				'dm-sans': { name: 'DM Sans', family: "'DM Sans', sans-serif", category: 'Modern' },
				'manrope': { name: 'Manrope', family: "'Manrope', sans-serif", category: 'Modern' },
				'plus-jakarta': { name: 'Plus Jakarta Sans', family: "'Plus Jakarta Sans', sans-serif", category: 'Modern' },
				'space-grotesk': { name: 'Space Grotesk', family: "'Space Grotesk', sans-serif", category: 'Modern' },
				'outfit': { name: 'Outfit', family: "'Outfit', sans-serif", category: 'Modern' },
				'epilogue': { name: 'Epilogue', family: "'Epilogue', sans-serif", category: 'Modern' },

				'source-sans': { name: 'Source Sans Pro', family: "'Source Sans Pro', sans-serif", category: 'Scientific' },
				'ibm-plex': { name: 'IBM Plex Sans', family: "'IBM Plex Sans', sans-serif", category: 'Scientific' },
				'fira-sans': { name: 'Fira Sans', family: "'Fira Sans', sans-serif", category: 'Scientific' },
				'work-sans': { name: 'Work Sans', family: "'Work Sans', sans-serif", category: 'Scientific' },

				'roboto': { name: 'Roboto', family: "'Roboto', sans-serif", category: 'Popular' },
				'open-sans': { name: 'Open Sans', family: "'Open Sans', sans-serif", category: 'Popular' },
				'lato': { name: 'Lato', family: "'Lato', sans-serif", category: 'Popular' },
				'montserrat': { name: 'Montserrat', family: "'Montserrat', sans-serif", category: 'Popular' },
				'poppins': { name: 'Poppins', family: "'Poppins', sans-serif", category: 'Popular' },
				'nunito-sans': { name: 'Nunito Sans', family: "'Nunito Sans', sans-serif", category: 'Popular' },

				'lexend': { name: 'Lexend', family: "'Lexend', sans-serif", category: 'Unique' },

				'fira-code': { name: 'Fira Code (Mono)', family: "'Fira Code', monospace", category: 'Exotic' },
				'space-mono': { name: 'Space Mono (Retro)', family: "'Space Mono', monospace", category: 'Exotic' },
				'orbitron': { name: 'Orbitron (Sci-Fi)', family: "'Orbitron', sans-serif", category: 'Exotic' },
				'rajdhani': { name: 'Rajdhani (Futuristic)', family: "'Rajdhani', sans-serif", category: 'Exotic' }
			};

			const initializeFontSwitcher = () => {
				populateFontDropdown();

				const savedFont = localStorage.getItem('selectedFont') || 'orbitron';
				applyFont(savedFont);

				document.getElementById('font-dropdown-btn')?.addEventListener('click', (e) => {
					e.stopPropagation();
					const dropdown = document.getElementById('font-dropdown');
					const arrow = document.getElementById('font-dropdown-arrow');

					if (dropdown.classList.contains('hidden')) {
						dropdown.classList.remove('hidden');
						arrow.style.transform = 'rotate(180deg)';
					} else {
						dropdown.classList.add('hidden');
						arrow.style.transform = 'rotate(0deg)';
					}
				});

				document.addEventListener('click', (e) => {
					if (!e.target.closest('#font-dropdown-btn')) {
						document.getElementById('font-dropdown')?.classList.add('hidden');
						document.getElementById('font-dropdown-arrow').style.transform = 'rotate(0deg)';
					}
				});
			};

			const populateFontDropdown = () => {
				const dropdown = document.getElementById('font-dropdown');
				if (!dropdown) return;

				dropdown.innerHTML = '';

				const categories = {};
				Object.entries(fonts).forEach(([fontKey, fontData]) => {
					const category = fontData.category || 'Other';
					if (!categories[category]) categories[category] = [];
					categories[category].push([fontKey, fontData]);
				});

				let isFirst = true;
				Object.entries(categories).forEach(([categoryName, categoryFonts]) => {
					if (!isFirst && categoryName !== 'System') {
						const header = document.createElement('div');
						header.className = 'px-3 py-1 text-xs font-medium text-gray-500 bg-gray-50 border-t';
						header.textContent = categoryName;
						dropdown.appendChild(header);
					}

					categoryFonts.forEach(([fontKey, fontData], index) => {
						const button = document.createElement('button');
						button.className = `font-option w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-600 transition-colors`;
						button.setAttribute('data-font', fontKey);

						if (isFirst && index === 0) button.classList.add('rounded-t-lg');

						button.textContent = fontData.name;
						button.style.fontFamily = fontData.family;
						button.addEventListener('click', (e) => {
							const selectedFont = e.target.getAttribute('data-font');
							applyFont(selectedFont);
							dropdown.classList.add('hidden');
							document.getElementById('font-dropdown-arrow').style.transform = 'rotate(0deg)';
						});
						dropdown.appendChild(button);
					});
					isFirst = false;
				});

				const lastButton = dropdown.lastElementChild;
				if (lastButton && lastButton.classList.contains('font-option')) {
					lastButton.classList.add('rounded-b-lg');
				}
			};

			const applyFont = (fontKey) => {
				const fontData = fonts[fontKey];
				if (!fontData) return;

				document.body.style.fontFamily = fontData.family;

				const currentFontDisplay = document.getElementById('current-font');
				if (currentFontDisplay) {
					currentFontDisplay.textContent = fontData.name;
				}

				localStorage.setItem('selectedFont', fontKey);

				document.body.style.transition = 'font-family 0.3s ease';
				setTimeout(() => {
					document.body.style.transition = '';
				}, 300);
			};

			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', initializeFontSwitcher);
			} else {
				initializeFontSwitcher();
			}
		})();

		(() => {
			function initTheme() {
				const savedTheme = localStorage.getItem('theme') || 'light';
				document.documentElement.setAttribute('data-theme', savedTheme);
				updateThemeButton(savedTheme);
			}

			function toggleTheme() {
				const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
				const newTheme = currentTheme === 'light' ? 'dark' : 'light';

				document.documentElement.setAttribute('data-theme', newTheme);
				localStorage.setItem('theme', newTheme);
				updateThemeButton(newTheme);

				if (typeof window.syncMobileThemeUI === 'function') {
					try { window.syncMobileThemeUI(newTheme); } catch (e) { }
				}
			}

			function updateThemeButton(theme) {
				const themeText = document.getElementById('theme-text');
				const sunIcon = document.getElementById('sun-icon');
				const moonIcon = document.getElementById('moon-icon');

				if (theme === 'dark') {
					themeText.innerHTML = 'Dark<sup style="color: red; font-style: italic; font-size: 0.7em;">beta</sup>';
					sunIcon.style.display = 'none';
					moonIcon.style.display = 'block';
				} else {
					themeText.textContent = 'Light';
					sunIcon.style.display = 'block';
					moonIcon.style.display = 'none';
				}
			}

			initTheme();
			window.updateThemeButton = updateThemeButton;
			window.toggleTheme = toggleTheme;

			document.addEventListener('DOMContentLoaded', () => {
				document.getElementById('theme-toggle')?.addEventListener('click', toggleTheme);
			});
		})();

		(() => {
			if (window.__gclusters_mobile_initialized) return;
			window.__gclusters_mobile_initialized = true;

			let isMenuOpen = false;

			const mobileMenuBtn = document.getElementById('mobile-menu-btn');
			const mobileMenu = document.getElementById('mobile-menu');
			const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
			const mobileMenuClose = document.getElementById('mobile-menu-close');

			const openMenu = () => {
				if (isMenuOpen) return;
				isMenuOpen = true;
				mobileMenuOverlay.classList.remove('hidden');
				mobileMenu.classList.remove('translate-x-full');
				document.body.style.overflow = 'hidden';
				setTimeout(() => mobileMenuOverlay.style.opacity = '1', 10);
			};

			const closeMenu = () => {
				if (!isMenuOpen) return;
				isMenuOpen = false;
				mobileMenu.classList.add('translate-x-full');
				mobileMenuOverlay.style.opacity = '0';
				document.body.style.overflow = '';
				setTimeout(() => mobileMenuOverlay.classList.add('hidden'), 300);
			};

			const populateMobileOptions = () => {
				const languageContainer = document.getElementById('mobile-language-options');
				if (!languageContainer || !window.SITE_TEXTS) return;

				languageContainer.innerHTML = '';
				const currentLang = window.getCurrentLanguage();
				const NAMES = window.LANGUAGE_NAMES_FULL;

				Object.keys(window.SITE_TEXTS).forEach(lang => {
					const isSelected = lang === currentLang;
					const option = document.createElement('button');
					option.className = `w-full flex items-center justify-between p-3 text-left bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors ${isSelected ? 'bg-blue-100 border-2 border-blue-300' : ''}`;
					option.innerHTML = `
						<div class="flex items-center gap-3"><span class="text-gray-800">${NAMES[lang]}</span></div>
						${isSelected ? '<svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>' : ''}
					`;

					option.addEventListener('click', () => {
						document.body.style.opacity = '0.7';
						setTimeout(() => {
							window.setLanguage(lang);
							if (typeof window.updateLanguageButtons === 'function') window.updateLanguageButtons(lang);
							if (typeof window.updatePageTexts === 'function') window.updatePageTexts(lang);
							document.documentElement.setAttribute('lang', lang);
							if (window.spaNavigator) {
								const currentPage = window.location.pathname.replace(/^\//, '').replace(/\.html$/, '') || 'home';
								window.spaNavigator.loadPageContent(currentPage);
							}
							populateMobileOptions();
							if (typeof closeMenu === 'function') closeMenu();
							document.body.style.opacity = '1';
						}, 300);
					});
					languageContainer.appendChild(option);
				});
			};

			const initMobileTheme = () => {
				const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
				const mobileThemeSwitch = document.getElementById('mobile-theme-switch');
				const mobileThemeText = document.getElementById('mobile-theme-text');

				const syncMobileThemeUI = (theme) => {
					if (theme === 'dark') {
						if (mobileThemeText) mobileThemeText.innerHTML = 'Dark<sup style="color: red; font-style: italic; font-size: 0.7em;">beta</sup>';
						if (mobileThemeSwitch) {
							mobileThemeSwitch.classList.remove('translate-x-1');
							mobileThemeSwitch.classList.add('translate-x-6');
						}
					} else {
						if (mobileThemeText) mobileThemeText.textContent = 'Light';
						if (mobileThemeSwitch) {
							mobileThemeSwitch.classList.remove('translate-x-6');
							mobileThemeSwitch.classList.add('translate-x-1');
						}
					}
				};

				syncMobileThemeUI(document.documentElement.getAttribute('data-theme') || 'light');
				window.syncMobileThemeUI = syncMobileThemeUI;

				mobileThemeToggle?.addEventListener('click', () => {
					if (typeof window.toggleTheme === 'function') {
						window.toggleTheme();
						syncMobileThemeUI(document.documentElement.getAttribute('data-theme') || 'light');
					} else {
						const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
						const newTheme = currentTheme === 'light' ? 'dark' : 'light';
						document.documentElement.setAttribute('data-theme', newTheme);
						localStorage.setItem('theme', newTheme);
						syncMobileThemeUI(newTheme);
					}
				});
			};

			mobileMenuBtn?.addEventListener('click', openMenu);
			mobileMenuClose?.addEventListener('click', closeMenu);
			mobileMenuOverlay?.addEventListener('click', closeMenu);

			document.addEventListener('keydown', (e) => {
				if (e.key === 'Escape' && isMenuOpen) closeMenu();
			});

			const initMobileMenu = () => { populateMobileOptions(); initMobileTheme(); };
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', initMobileMenu);
			} else {
				initMobileMenu();
			}

			window.addEventListener('languageChanged', populateMobileOptions);

			const mq = window.matchMedia('(min-width: 1174px)');
			const updateForQuery = (m) => {
				const desktopControls = document.getElementById('desktop-controls');
				const fullText = document.querySelector('#header-title .full-text');
				const mobileShort = document.querySelector('#header-title .mobile-short');
				const isDesktop = m.matches;
				if (!isDesktop) {
					if (desktopControls) desktopControls.style.display = 'none';
					if (mobileMenuBtn) mobileMenuBtn.style.display = 'block';
					if (fullText) fullText.style.display = 'none';
					if (mobileShort) mobileShort.style.display = 'inline';
				} else {
					if (desktopControls) desktopControls.style.display = 'flex';
					if (mobileMenuBtn) mobileMenuBtn.style.display = 'none';
					if (fullText) fullText.style.display = 'inline';
					if (mobileShort) mobileShort.style.display = 'none';
					if (isMenuOpen) closeMenu();
				}
			};

			updateForQuery(mq);
			if (typeof mq.addEventListener === 'function') mq.addEventListener('change', updateForQuery);
			else if (typeof mq.addListener === 'function') mq.addListener(updateForQuery);
		})();
	</script>
</body>

</html>
